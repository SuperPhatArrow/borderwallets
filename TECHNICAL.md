# Border Wallets Entropy Grid Generator Technical Information

## Grid Generation
There are two options available for generating a new grid: deterministic or maximum entropy.

#### Deterministic Entropy Grids
In order to generate a deterministic grid, first 128 bits of entropy are generated using the browser's built-in Cryptography API. This is converted into a valid 12 word seed phrase as specified in [BIP39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki).

The seed phrase is then used to seed [Gibson Research Corporation's Ultra-High Entropy Pseudo-Random Number Generator (UHEPRNG)](https://www.grc.com/otg/uheprng.htm) and a [Fisher-Yates Shuffle Algorithm](https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle) with random numbers taken from the UHEPRNG.

This allows the user to reproduce the same grid in future using the same seed words. The seed words are printed on the bottom of the Entropy Grid PDF file.

#### Maximum Entropy Grids
Here the Fisher-Yates shuffle is used, but a random number is generated by the Cryptography API, maximising the total number of possible grids to `2048!` which is roughly equal to 1.67269 &times; 10<sup>5894</sup>

## Encryption and Decryption
The tool allows the user to drag-and-drop or select a file to either encrypt or decrypt.

If the file has the file extension suffix of `.bweg` (for Border Wallet Entropy Grid) the tool will decrypt the file.

Guidelines layed out in the NIST paper [Recommendation for Password-Based Key
Derivation](https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-132.pdf) are used and the tool uses the following:
- PBKDF2
- HMAC with SHA-256
- AES-GCM
- 256 bit Salt
- 96 bit IV
- 10,000,000 Iteration Count

The Dropbox library [zxcvbn](https://github.com/dropbox/zxcvbn) is used to test password strength and the tool will prevent encryption of any file where the password used for encryption does not score at least `4` by zxcvbn.

The high iteration count takes quite a long time on a standard PC but since the user only needs to do this twice (once for encryption and once for decryption), it will help to increase the cost of a brute force or dictionary attack.

Although the tool allows any file to be encrypted, it is optimised for the Entropy Grid PDF file. Larger files may not work.



